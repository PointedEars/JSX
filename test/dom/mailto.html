<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>mailto: URI scheme triggered with client-side scripting –
      DOM Test Cases — PointedEars' Website</title>
    <style type="text/css">
      <!--
      th
      {
        text-align: left;
      }
      
      td input[type="text"],
      td input[type="email"]
      {
        width: 100%;
      }
      
      iframe {
        display: none;
      }
      -->
    </style>
    <script type="text/javascript">
      function random ()
      {
        var r = Math.random();
        if (r === 1)
        {
          r = 0;
        }
        
        return r;
      }
    
      function randomIntRange (leftBound, rightBound)
      {
        leftBound = (+leftBound);
        return leftBound + Math.floor(random() * (+rightBound - leftBound));
      }
    
      function randomASCIIString (length)
      {
        var a = [];
        a.length = length;
        var leftBound = "A".charCodeAt(0);
        var rightBound = "z".charCodeAt(0);
        
        for (var i = 0, len = a.length; i < len; ++i)
        {
          var rnd = randomIntRange(leftBound, rightBound);
          a[i] = String.fromCharCode(rnd);
        }
        
        return a.join("");
      }
    
      function generateMail (form)
      {
        var el = form.elements;
        var subject = el["subject"].value;
        var data = el["data"].value;
        var uri = "mailto:" + el["recipient"].value + "?"
          + (subject ? "subject=" + encodeURIComponent(subject) + "&" : "")
          + "body="
          + encodeURIComponent(data || randomASCIIString(447));
         
        var div = document.createElement("div");
        div.appendChild(document.createTextNode(uri));
        document.body.appendChild(div);
        try
        {
          window.location = uri;
          return false;
        }
        catch (e)
        {
          window.alert("location = 'mailto:' not supported."
            + " Please copy the displayed information to the e-mail"
            + " window if necessary.");
          form.action = uri;
        }
      }
    </script>
  </head>

  <body>
    <h1>mailto: URI scheme triggered with client-side scripting</h1>
    <form onsubmit="return generateMail(this)" target="iframe">
      <table>
        <tr>
          <th><label for="recipient" title="Recipient">To:</label></th>
          <td><input name="recipient" id="recipient" type="email"
                     value="foo@bar" placeholder="recipient"></td>
        </tr>
        <tr>
          <th><label for="subject">Subject:</label></th>
          <td><input name="subject" id="subject" type="text"
                     value="baz" placeholder="e-mail subject"></td>
        </tr>
        <tr>
          <th style="vertical-align: top; vertical-align: baseline"
              ><label for="data">Data:</label></th>
          <td><textarea name="data" id="data" cols="30"
                        placeholder="447 random characters if empty"
                        ></textarea></td>
        </tr>
        <tr>
          <td colspan="2" style="text-align: right"><input
            type="submit" value="Generate E-mail"></td>
        </tr>
      </table>
    </form>
    <iframe name="iframe"></iframe>
  </body>
</html>